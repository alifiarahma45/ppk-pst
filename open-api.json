{"openapi":"3.0.1","info":{"title":"OpenAPI definition","version":"v0"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"paths":{"/profile/password":{"put":{"tags":["profile-controller"],"summary":"Mengubah kata sandi pengguna yang terautentikasi","operationId":"changePassword","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangePasswordRequest"}}},"required":true},"responses":{"200":{"description":"Berhasil mengubah kata sandi","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}}},"401":{"description":"Pengguna belum terautentikasi"},"400":{"description":"Kata sandi lama tidak sesuai"}}}},"/profile/detail":{"put":{"tags":["profile-controller"],"summary":"Mengupdate detail profil berupa identitas pengguna yang terautentikasi.","description":"Hanya pengguna yang memiliki identitas dan diizinkan memperbaruinya.","operationId":"updateProfile","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IdentitasDto"}}},"required":true},"responses":{"403":{"description":"Admin tidak memiliki identitas untuk diubah"},"401":{"description":"Pengguna belum terautentikasi"},"200":{"description":"Berhasil mengubah detail profil pengguna","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IdentitasDto"}}}}}}},"/permintaan/{id}":{"get":{"tags":["permintaan-controller"],"summary":"Melihat permintaan berdasarkan ID","description":"Admin bisa mengakses seluruh id permintaan, untuk pengguna yang terautentikasi hanya diizinkan mengakses miliknya.","operationId":"getPermintaanById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"Permintaan ditemukan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}},"404":{"description":"Permintaan tidak ditemukan","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}}}},"put":{"tags":["permintaan-controller"],"summary":"Mengupdate permintaan data","description":"Mengupdate permintaan hanya jika status permintaan adalah 'DIPROSES' dan pengguna adalah pemilik permintaan.","operationId":"updatePermintaan","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}},"required":true},"responses":{"403":{"description":"Tidak memiliki izin untuk mengubah permintaan"},"200":{"description":"Permintaan berhasil diperbarui","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}},"404":{"description":"Permintaan tidak ditemukan"}}},"delete":{"tags":["permintaan-controller"],"summary":"Menghapus permintaan data","description":"Pengguna hanya dapat menghapus permintaannya sendiri yang statusnya masih 'DIPROSES'.","operationId":"deletePermintaan","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"204":{"description":"Permintaan berhasil dihapus"},"404":{"description":"Permintaan tidak ditemukan"},"403":{"description":"Hanya pengguna yang dapat menghapus permintaannya sendiri"}}}},"/kunjungan/{id}":{"get":{"tags":["kunjungan-controller"],"summary":"Menampilkan detail kunjungan beserta informasi user dan identitas","operationId":"getKunjunganById","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"Detail kunjungan dengan user dan identitas","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}},"404":{"description":"Kunjungan tidak ditemukan","content":{"*/*":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}}}},"put":{"tags":["kunjungan-controller"],"summary":"Memperbarui data kunjungan","description":"Pengguna dapat memperbarui data kunjungan mereka sendiri atau sebagai admin.","operationId":"updateKunjungan","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}},"required":true},"responses":{"404":{"description":"Data kunjungan tidak ditemukan","content":{"*/*":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}},"403":{"description":"Tidak diizinkan untuk mengubah data kunjungan milik pengguna lain","content":{"*/*":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}},"200":{"description":"Data kunjungan berhasil diperbarui","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}},"400":{"description":"Permintaan tidak valid atau terdapat kesalahan pada data","content":{"*/*":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}}}},"delete":{"tags":["kunjungan-controller"],"summary":"Menghapus kunjungan berdasarkan ID","description":"Hanya admin yang diizinkan menghapus kunjungan yang tidak sesuai.","operationId":"deleteKunjungan","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"404":{"description":"Kunjungan tidak ditemukan"},"403":{"description":"Tidak diizinkan untuk menghapus kunjungan"},"200":{"description":"Kunjungan berhasil dihapus"}}}},"/register":{"post":{"tags":["authentication-controller"],"summary":"Mendaftar pengguna baru dengan email unik.","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}},"required":true},"responses":{"200":{"description":"Pengguna berhasil didaftarkan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}}},"400":{"description":"Data yang diberikan tidak valid atau email sudah terdaftar","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"},"example":{"message":"Email user2@example.com sudah terdaftar."}}}},"500":{"description":"Terjadi kesalahan pada server"}}}},"/permintaan":{"get":{"tags":["permintaan-controller"],"summary":"Melihat permintaan data","description":"Menampilkan seluruh permintaan untuk admin atau permintaan milik pengguna yang terautentikasi.","operationId":"getPermintaan","parameters":[{"name":"status","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"Permintaan ditemukan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}},"404":{"description":"Permintaan tidak ditemukan","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PermintaanDto"}}}}},"403":{"description":"Tidak dapat mengakses permintaan milik pengguna lain","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PermintaanDto"}}}}}}},"post":{"tags":["permintaan-controller"],"summary":"Menambahkan permintaan data","description":"Hanya pengguna dengan role USER yang dapat menambahkan permintaan baru.","operationId":"addPermintaan","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}},"required":true},"responses":{"400":{"description":"Permintaan gagal ditambahkan, kesalahan pada data input","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}},"201":{"description":"Permintaan berhasil ditambahkan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}}}}},"/login":{"post":{"tags":["authentication-controller"],"summary":"Pengguna login untuk mendapatkan token akses.","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthRequest"}}},"required":true},"responses":{"401":{"description":"Akses ditolak karena kredensial tidak valid"},"200":{"description":"Berhasil login dan menerima token akses","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"400":{"description":"Kredensial yang diberikan tidak valid"}}}},"/kunjungan":{"get":{"tags":["kunjungan-controller"],"summary":"Melihat seluruh kunjungan berdasarkan peran user yang terautentikasi. ","description":"Menampilkan seluruh kunjungan untuk admin atau kunjungan yang dimiliki user terautentikasi. ","operationId":"getKunjunganByLoggedInUser","responses":{"200":{"description":"Daftar kunjungan ditemukan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}}}},"post":{"tags":["kunjungan-controller"],"summary":"Menambahkan kunjungan hanya untuk pengguna yang terautentikasi.","operationId":"createKunjungan","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}},"required":true},"responses":{"201":{"description":"Kunjungan berhasil dibuat","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}}}}},"/permintaan/{id}/status":{"patch":{"tags":["permintaan-controller"],"summary":"Mengupdate status permintaan","description":"Hanya pengguna dengan role ADMIN yang dapat mengupdate status permintaan.","operationId":"updateStatusPermintaan","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"status","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Status permintaan berhasil diperbarui","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}},"404":{"description":"Permintaan tidak ditemukan","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}},"403":{"description":"Tidak memiliki izin untuk mengubah status permintaan","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PermintaanDto"}}}}}}},"/users":{"get":{"tags":["account-controller"],"summary":"Menampilkan seluruh user yang terdaftar dalam sistem.","description":"Hanya admin yang bisa mengakses uses terdaftar dan melakukan pencarian akun berdasarkan role.","operationId":"getAllUsers","parameters":[{"name":"role","in":"query","required":false,"schema":{"type":"string"}}],"responses":{"200":{"description":"Seluruh data user berdasarkan role","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDto"}}}}},"403":{"description":"Akses ditolak, hanya untuk Admin","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDto"}}}}}}}},"/users/search":{"get":{"tags":["account-controller"],"summary":"Mencari pengguna berdasarkan nama.","description":"Hanya admin yang bisa melakukan pencarian berdasarkan nama pengguna.","operationId":"searchUsersByName","parameters":[{"name":"name","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"403":{"description":"Akses ditolak, hanya untuk Admin","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDto"}}}}},"200":{"description":"Daftar pengguna yang cocok dengan pencarian nama","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserDto"}}}}}}}},"/profile":{"get":{"tags":["profile-controller"],"summary":"Melihat data pengguna yang terautentikasi.","description":"Menampilkan profil akun pengguna/admin yang terautentikasi.","operationId":"getProfile","responses":{"200":{"description":"Berhasil mendapatkan data pengguna","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDto"}}}},"401":{"description":"Pengguna belum terotentikasi"}}},"delete":{"tags":["profile-controller"],"summary":"Menghapus akun pengguna/admin yang terautentikasi beserta identitasnya.","operationId":"deleteProfile","responses":{"409":{"description":"Akun tidak bisa dihapus karena memiliki data permintaan atau kunjungan"},"200":{"description":"Berhasil menghapus akun pengguna"},"403":{"description":"Pengguna tidak memiliki hak untuk menghapus akun"},"401":{"description":"Pengguna belum terotentikasi"}}}},"/kunjungan/tanggal":{"get":{"tags":["kunjungan-controller"],"summary":"Menampilkan kunjungan yang dilakukan pada tanggal tertentu","description":"Menampilkan kunjungan sesuai untuk admin atau kunjungan yang dimiliki user terautentikasi. ","operationId":"getKunjunganByDate","parameters":[{"name":"date","in":"query","required":true,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"Daftar kunjungan pada tanggal tertentu","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KunjunganDto"}}}}}}}},"/kunjungan/keperluan":{"get":{"tags":["kunjungan-controller"],"summary":"Mencari kunjungan berdasarkan keperluan.","description":"Menampilkan kunjungan sesuai untuk admin atau kunjungan yang dimiliki user terautentikasi. ","operationId":"searchKunjunganByKeperluan","parameters":[{"name":"keperluan","in":"query","required":true,"schema":{"type":"string","enum":["PERPUSTAKAAN","KONSULTASI_STATISTIK","PERMINTAAN_DATA","REKOMENDASI_STATISTIK","PEMBELIAN_DATA"]}}],"responses":{"404":{"description":"Kunjungan tidak ditemukan","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KunjunganDto"}}}}},"200":{"description":"Daftar kunjungan ditemukan berdasarkan keperluan","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}}}}},"/kunjungan/daritanggal":{"get":{"tags":["kunjungan-controller"],"summary":"Mencari kunjungan berdasarkan rentang tanggal.","description":"Hanya untuk admin. ","operationId":"searchKunjunganByDateRange","parameters":[{"name":"startDate","in":"query","required":true,"schema":{"type":"string","format":"date-time"}},{"name":"endDate","in":"query","required":true,"schema":{"type":"string","format":"date-time"}}],"responses":{"404":{"description":"Kunjungan tidak ditemukan","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KunjunganDto"}}}}},"200":{"description":"Daftar kunjungan ditemukan berdasarkan tanggal","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KunjunganDto"}}}}}}}},"components":{"schemas":{"ChangePasswordRequest":{"required":["newPassword","oldPassword"],"type":"object","properties":{"oldPassword":{"type":"string"},"newPassword":{"type":"string"}}},"GrantedAuthority":{"type":"object","properties":{"authority":{"type":"string"}}},"IdentitasDto":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"nama":{"type":"string"},"tanggalLahir":{"type":"string","format":"date"},"pekerjaan":{"type":"string"},"asalInstansi":{"type":"string"},"jenisKelamin":{"type":"string"},"nomorHp":{"type":"string"},"user":{"$ref":"#/components/schemas/UserDto"}}},"UserDto":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"email":{"type":"string"},"password":{"type":"string"},"role":{"type":"string"},"identitas":{"$ref":"#/components/schemas/IdentitasDto"},"enabled":{"type":"boolean"},"username":{"type":"string"},"authorities":{"type":"array","items":{"$ref":"#/components/schemas/GrantedAuthority"}},"credentialsNonExpired":{"type":"boolean"},"accountNonExpired":{"type":"boolean"},"accountNonLocked":{"type":"boolean"}}},"PermintaanDto":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"user":{"$ref":"#/components/schemas/UserDto"},"tanggalPermintaan":{"type":"string","format":"date"},"data":{"type":"string"},"keterangan":{"type":"string"},"status":{"type":"string"}}},"KunjunganDto":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"user":{"$ref":"#/components/schemas/UserDto"},"tanggalKunjungan":{"type":"string","format":"date-time"},"keperluan":{"type":"string","enum":["PERPUSTAKAAN","KONSULTASI_STATISTIK","PERMINTAAN_DATA","REKOMENDASI_STATISTIK","PEMBELIAN_DATA"]},"keterangan":{"type":"string"}}},"ContentDisposition":{"type":"object","properties":{"type":{"type":"string"},"name":{"type":"string"},"filename":{"type":"string"},"charset":{"type":"string"},"size":{"type":"integer","format":"int64","deprecated":true},"creationDate":{"type":"string","format":"date-time","deprecated":true},"modificationDate":{"type":"string","format":"date-time","deprecated":true},"readDate":{"type":"string","format":"date-time","deprecated":true},"inline":{"type":"boolean"},"attachment":{"type":"boolean"},"formData":{"type":"boolean"}}},"ErrorResponse":{"type":"object","properties":{"body":{"$ref":"#/components/schemas/ProblemDetail"},"titleMessageCode":{"type":"string"},"detailMessageCode":{"type":"string"},"detailMessageArguments":{"type":"array","items":{"type":"object"}},"statusCode":{"$ref":"#/components/schemas/HttpStatusCode"},"typeMessageCode":{"type":"string"},"headers":{"type":"object","properties":{"empty":{"type":"boolean"},"location":{"type":"string","format":"uri"},"host":{"type":"object","properties":{"address":{"type":"object","properties":{"hostAddress":{"type":"string"},"address":{"type":"array","items":{"type":"string","format":"byte"}},"hostName":{"type":"string"},"linkLocalAddress":{"type":"boolean"},"multicastAddress":{"type":"boolean"},"anyLocalAddress":{"type":"boolean"},"loopbackAddress":{"type":"boolean"},"siteLocalAddress":{"type":"boolean"},"mcglobal":{"type":"boolean"},"mcnodeLocal":{"type":"boolean"},"mclinkLocal":{"type":"boolean"},"mcsiteLocal":{"type":"boolean"},"mcorgLocal":{"type":"boolean"},"canonicalHostName":{"type":"string"}}},"port":{"type":"integer","format":"int32"},"unresolved":{"type":"boolean"},"hostName":{"type":"string"},"hostString":{"type":"string"}}},"all":{"type":"object","additionalProperties":{"type":"string"},"writeOnly":true},"lastModified":{"type":"integer","format":"int64"},"date":{"type":"integer","format":"int64"},"contentLength":{"type":"integer","format":"int64"},"range":{"type":"array","items":{"$ref":"#/components/schemas/HttpRange"}},"contentDisposition":{"$ref":"#/components/schemas/ContentDisposition"},"acceptCharset":{"type":"array","items":{"type":"string"}},"cacheControl":{"type":"string"},"allow":{"uniqueItems":true,"type":"array","items":{"$ref":"#/components/schemas/HttpMethod"}},"contentLanguage":{"type":"object","properties":{"language":{"type":"string"},"displayName":{"type":"string"},"country":{"type":"string"},"variant":{"type":"string"},"script":{"type":"string"},"unicodeLocaleAttributes":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"unicodeLocaleKeys":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"displayLanguage":{"type":"string"},"displayScript":{"type":"string"},"displayCountry":{"type":"string"},"displayVariant":{"type":"string"},"extensionKeys":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"iso3Language":{"type":"string"},"iso3Country":{"type":"string"}}},"etag":{"type":"string"},"accept":{"type":"array","items":{"$ref":"#/components/schemas/MediaType"}},"acceptPatch":{"type":"array","items":{"$ref":"#/components/schemas/MediaType"}},"acceptLanguage":{"type":"array","items":{"type":"object","properties":{"range":{"type":"string"},"weight":{"type":"number","format":"double"}}}},"basicAuth":{"type":"string","writeOnly":true},"ifNoneMatch":{"type":"array","items":{"type":"string"}},"connection":{"type":"array","items":{"type":"string"}},"bearerAuth":{"type":"string","writeOnly":true},"accessControlMaxAge":{"type":"integer","format":"int64"},"acceptLanguageAsLocales":{"type":"array","items":{"type":"object","properties":{"language":{"type":"string"},"displayName":{"type":"string"},"country":{"type":"string"},"variant":{"type":"string"},"script":{"type":"string"},"unicodeLocaleAttributes":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"unicodeLocaleKeys":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"displayLanguage":{"type":"string"},"displayScript":{"type":"string"},"displayCountry":{"type":"string"},"displayVariant":{"type":"string"},"extensionKeys":{"uniqueItems":true,"type":"array","items":{"type":"string"}},"iso3Language":{"type":"string"},"iso3Country":{"type":"string"}}}},"ifUnmodifiedSince":{"type":"integer","format":"int64"},"accessControlRequestHeaders":{"type":"array","items":{"type":"string"}},"accessControlRequestMethod":{"$ref":"#/components/schemas/HttpMethod"},"accessControlExposeHeaders":{"type":"array","items":{"type":"string"}},"accessControlAllowOrigin":{"type":"string"},"accessControlAllowCredentials":{"type":"boolean"},"accessControlAllowMethods":{"type":"array","items":{"$ref":"#/components/schemas/HttpMethod"}},"accessControlAllowHeaders":{"type":"array","items":{"type":"string"}},"expires":{"type":"integer","format":"int64"},"origin":{"type":"string"},"ifMatch":{"type":"array","items":{"type":"string"}},"pragma":{"type":"string"},"vary":{"type":"array","items":{"type":"string"}},"upgrade":{"type":"string"},"ifModifiedSince":{"type":"integer","format":"int64"},"contentType":{"$ref":"#/components/schemas/MediaType"}},"additionalProperties":{"type":"array","items":{"type":"string"}}}}},"HttpMethod":{"type":"object"},"HttpRange":{"type":"object"},"HttpStatusCode":{"type":"object","properties":{"error":{"type":"boolean"},"is5xxServerError":{"type":"boolean"},"is1xxInformational":{"type":"boolean"},"is4xxClientError":{"type":"boolean"},"is2xxSuccessful":{"type":"boolean"},"is3xxRedirection":{"type":"boolean"}}},"MediaType":{"type":"object","properties":{"type":{"type":"string"},"subtype":{"type":"string"},"parameters":{"type":"object","additionalProperties":{"type":"string"}},"qualityValue":{"type":"number","format":"double"},"concrete":{"type":"boolean"},"wildcardSubtype":{"type":"boolean"},"wildcardType":{"type":"boolean"},"subtypeSuffix":{"type":"string"},"charset":{"type":"string"}}},"ProblemDetail":{"type":"object","properties":{"type":{"type":"string","format":"uri"},"title":{"type":"string"},"status":{"type":"integer","format":"int32"},"detail":{"type":"string"},"instance":{"type":"string","format":"uri"},"properties":{"type":"object","additionalProperties":{"type":"object"}}}},"AuthRequest":{"required":["email","password"],"type":"object","properties":{"email":{"type":"string"},"password":{"type":"string"}}},"AuthResponse":{"type":"object","properties":{"email":{"type":"string"},"accessToken":{"type":"string"}}}}}}